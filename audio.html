<!doctype html>
<html>
  <head>
    <title>Audio</title>
  </head>
  <body>

    <script src="audiosynth.js"></script>
    <script>

      var dict = 
      {
        '-6': ["C", 3, 1],
        '-5': ["D", 3, 1],
        '-4': ["E", 3, 1],
        '-3': ["F", 3, 1],
        '-2': ["G", 3, 1],
        '-1': ["A", 3, 1],
        '0': ["B", 3, 1],
        '1': ["C", 4, 1],
        '2': ["D", 4, 1],
        '3': ["E", 4, 1],
        '4': ["F", 4, 1],
        '5': ["G", 4, 1],
        '6': ["A", 4, 1],
        '7': ["B", 4, 1],
        '8': ["C", 5, 1],
        '9': ["D", 5, 1],
        '10': ["E", 5, 1],
        '11': ["F", 5, 1],
        '12': ["G", 5, 1],
        '13': ["A", 5, 1],
        '14': ["B", 5, 1]
      };

      var num_iter = 4;
      
      function play(val) 
      {
        var piano = Synth.createInstrument('piano');
        note = val+"";
        document.getElementById('seq').value = document.getElementById('seq').value + note;
        piano.play(dict[note][0], dict[note][1], dict[note][2]);
      }

      function play_sequence(dirn) 
      {
        var seq = document.getElementById('seq').value.split("").map(Number);
        console.log(seq);

        var sequence = [];

        if(dirn == 'U')
        {
          for(i = 0; i < num_iter; i++)
          {
            sequence = sequence.concat(seq.map(n => n + i))
          }
        }

        if(dirn == 'D')
        {
          for(i = 0; i < num_iter; i++)
          {
            sequence = sequence.concat(seq.map(n => n - i))
          }
        }


        console.log(sequence);
        var position = 0;
        var piano = Synth.createInstrument('piano');

        function sequencer()
        {
          var note = sequence[position]+"";
          position += 1;
          if(position >= sequence.length) 
          {
              clearInterval(interval);
          }

          piano.play(dict[note][0], dict[note][1], dict[note][2]);
          
        }

        interval = setInterval(sequencer, 1000/4);
      }

      function clear_sequence() 
      {
        document.getElementById('seq').value = "";
      }


    </script>

    <center>

    <h2>Alankar Maker</h2>
    <input type="button" id="sa" value="1" onclick="play(parseInt(this.value))"> 
    <input type="button" id="re" value="2" onclick="play(parseInt(this.value))">
    <input type="button" id="ga" value="3" onclick="play(parseInt(this.value))">
    <input type="button" id="ma" value="4" onclick="play(parseInt(this.value))">
    <input type="button" id="pa" value="5" onclick="play(parseInt(this.value))">
    <input type="button" id="dha" value="6" onclick="play(parseInt(this.value))">
    <input type="button" id="ni" value="7" onclick="play(parseInt(this.value))">


    <br><br><br>
    <input type="text" id="seq">
    <input type="button" id="clear_sequence" value="Clear" onclick="clear_sequence()">
    <input type="button" id="play_sequence" value="Play Up" onclick="play_sequence('U')">
    <input type="button" id="play_sequence" value="Play Down" onclick="play_sequence('D')">
    </center>

  </body>
</html>